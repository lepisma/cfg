#!/usr/bin/env fish

if test (count $argv) -eq 0
    echo "No photo path provided."
    exit 1
end

set photo_path $argv[1]
set kindle_width 600
set kindle_height 800

set uuid (uuidgen)
set output_file "photoframe-$uuid.pdf"

convert $photo_path -modulate 140 -resize $kindle_width"x"$kindle_height^ -gravity center -crop $kindle_width"x"$kindle_height+0+0 +repage -background white $output_file
echo "Generated file: $output_file"

mv $output_file /run/media/lepisma/Kindle/documents
echo "Moved to Kindle"
